# Changelog

## [0.2.4] - 2026-01-22

### Fixed

- **useDrag空配列エラー**: タスクが0件の場合の境界値エラーを修正
- **useDragゼロ除算**: 進捗ドラッグ時のゼロ除算エラーを修正
- **position.ts負数値**: calculateTimelineWidthで負の期間を防止
- **useResourceLayout空リソース**: 空またはタスク1件のリソースのスタックレベル計算を修正
- **DependencyLayer null安全化**: non-null assertion（!）を安全なnullチェックに置換
- **useSyncScroll RAFクリーンアップ**: ネストされたrequestAnimationFrameの適切なキャンセル処理

### Improved

- **useTaskPositions**: useMemo→useCallbackに修正（関数のメモ化として正しいパターン）
- **GridCell型安全性**: セル値取得時の型チェックを改善
- **Gantt.tsx relatedIds最適化**: O(n²)→O(n)に計算量を削減（Mapベースのインデックス化）

### Added

- **ユニットテスト**: utils/position.ts, utils/tree.ts, utils/capacity.tsのテストを追加（67テスト）
- **APIドキュメント更新**: docs/API.mdを最新の型定義・Props・Hooksに完全対応

## [0.2.3] - 2026-01-22

### Fixed

- **Grid/Timeline行同期**: リソースモードでグリッドとタイムラインの行位置がずれる問題を修正（virtualizer同期）
- **タスクバー位置**: 段組み表示時のタスクバー垂直位置を正しく計算するよう修正

## [0.2.2] - 2026-01-22

### Fixed

- **重複タスクの段組み表示改善**: タスクバーの高さを維持したまま行を拡張するよう修正

## [0.2.1] - 2026-01-22

### Fixed

- **納期マーカーエラー修正**: リソースモードで`showTaskDeadlines={true}`時のTypeError修正
- **依存関係線のリソースモード対応**: リソースモードでも依存線が正しく描画されるよう修正
- **タスクバーのタイトル折り返し**: タイトルは1行で表示し、はみ出す部分は省略記号（...）で切り詰め（既存実装の確認）

### Added

- **重複タスクの段組み表示**: 同一リソース内で時間的に重複するタスクを自動でスタック表示（行の高さを拡張）
- **リソース固有の非稼働時間**: `NonWorkingPeriod.resourceId`で特定リソースのみに非稼働時間を設定可能
- **グループヘッダーのサマリーバー**: リソースモードでグループヘッダー行にグループ期間を示す細いグレーのバーを表示

## [0.2.0] - 2026-01-22

### Added

- **リソースビュー**: リソース（人・設備等）単位でタスクを表示（1行=1リソースで複数タスク表示）

## [0.1.0] - 2026-01-22

### Added

- **タスクの行間ドラッグ移動**: タスクを別の行にドラッグで移動可能
- **複合タスクバー**: セグメント分割表示（準備/作業/バッファ等）
- **マーカー/マイルストーンライン**: 期限やイベントの縦線表示
- **依存関係線**: タスク間の依存関係を矢印で表示（FS/SS/FF/SF）
- **非稼働時間帯**: 休日・休憩時間のグレーアウト表示
- **キャパシティインジケーター**: リソース負荷率の可視化
- **関連タスクハイライト**: 選択タスクの関連タスクを強調表示
- **ドロップターゲットハイライト**: ドラッグ中のターゲット行を視覚的に表示

## [0.0.1] - 2026-01-21

### Added

- メインコンポーネント `<Gantt>`
- タスク表示（task / milestone / group）
- 仮想スクロール（@tanstack/react-virtual）
- ズームレベル（hour / day / week / month）
- ドラッグ編集（移動・リサイズ）
- 複数選択（Ctrl/Cmd + クリック）
- カスタム列定義
- CSS変数によるテーマ
- 親子タスク階層
- `locale` による国際化
